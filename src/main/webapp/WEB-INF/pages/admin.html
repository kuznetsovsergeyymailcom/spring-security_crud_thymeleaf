<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin</title>
    <style>
        body{background:#f9f9f9;}
        #wrapper{padding:90px 15px;}
        .navbar-expand-lg .navbar-nav.side-nav{flex-direction: column;}
        .card{margin-bottom: 15px; border-radius:0; box-shadow: 0 3px 5px rgba(0,0,0,.1); }
        .header-top{box-shadow: 0 3px 5px rgba(0,0,0,.1)}
        @media(min-width:992px) {
            #wrapper{margin-left: 200px;padding: 90px 15px 15px;}
            .navbar-nav.side-nav{background: #585f66;box-shadow: 2px 1px 2px rgba(0,0,0,.1);position:fixed;top:56px;flex-direction: column!important;left:0;width:200px;overflow-y:auto;bottom:0;overflow-x:hidden;padding-bottom:40px}
        }
    </style>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
          rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
            integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"
            integrity="sha384-u/bQvRA/1bobcXlcEYpsEdFVK/vJs3+T+nXLsBYJthmdBuavHvAW6UsmqO2Gd/F9" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){

            $("#tableUsers").on('click','#editModalShow',function(){

                console.log("button pressed");
                var currentRow=$(this).closest("tr");

                var colId=currentRow.find("td:eq(0)").text();
                var colLogin=currentRow.find("td:eq(1)").text();
                var colPass=currentRow.find("td:eq(2)").text();
                var colEmail=currentRow.find("td:eq(3)").text();

                $("#modal_id").val(colId);
                $("#modal_login").val(colLogin);
                $("#modal_email").val(colEmail);
                $("#modal_password").val(colPass);

                $('#userEdit').modal('show');
            });
        });

    </script>

</head>
<body>


<div id="wrapper">
    <nav class="navbar header-top fixed-top navbar-expand-lg  navbar-dark bg-dark">
        <a class="navbar-brand" href="#">Project name</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
                aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav side-nav bg-white">
                <li class="nav-item">
                    <a class="nav-link text-primary" href="/admin">Admin</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-primary" href="/user">User</a>
                </li>
            </ul>
            <ul class="navbar-nav ml-md-auto d-md-flex">

                <li class="nav-item">
                    <a class="nav-link" href="/logout">Log out</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container-fluid">
        <p><h2>Admin Panel</h2></p>
        <nav class="nav">
            <a class="nav-link active" href="/admin">Users table</a>
            <a class="nav-link" th:href="${'/admin/addUser'}">Add new User</a>
        </nav>


        <div class="row">
            <div align="center">
                <table class="table table-bordred table-striped ml-3" id="tableUsers">
                    <section class="text-info ">All users</section>
                    <thead class="thead-light">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Password</th>
                        <th>Email</th>
                        <th>Role</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr scope="row" th:each="user : ${users}">
                        <td th:text="${user.id}" id="user.id">${user.id}</td>
                        <td th:text="${user.login}" id="user.login">${user.login}</td>
                        <td th:text="${user.password}" id="user.password">${user.password}</td>
                        <td th:text="${user.email}" id="user.email">${user.email}</td>
                        <td th:text="${user.roles}" id="user.roles">${user.roles}</td>
                        <td>

                            <button id="editModalShow" class="btn btn-primary" value="Edit" >Edit</button>
                            <a th:href="${'/admin/delete/' + user.id}" class="btn btn-primary">Delete</a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>


            <div class="fade modal" id="userEdit">
                <div class="modal-dialog">
                    <div class="modal-content">

                        <div class="modal-body">
                            <div class="col-md-12">
                                <span class="anchor" id="formUpdate"></span>
                                <hr class="mb-5">

                                <!-- form card register -->
                                <div class="card card-outline-secondary w-100">
                                    <div class="card-header">
                                        <h3 class="mb-0">Edit user</h3>
                                    </div>
                                    <div class="card-body">
                                        <form class="form" role="form" autocomplete="off" th:action="@{/admin/edit}" method="post">
                                            <div class="form-group">
                                                <label for="modal_id">ID</label>
                                                <input type="text" class="form-control"
                                                       id="modal_id" th:name="id" readonly>
                                            </div>
                                            <div class="form-group">
                                                <label for="modal_login">Name</label>
                                                <input type="text" class="form-control"
                                                       id="modal_login" th:name="login" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="modal_email">Email</label>
                                                <input type="email" class="form-control"
                                                       id="modal_email" th:name="email" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="modal_password">Password</label>
                                                <input type="password" class="form-control"
                                                       id="modal_password" th:name="password" required>
                                            </div>

                                            <div class="form-group">

                                                <div class="input-group mb-2 mr-sm-2 mb-sm-0">
                                                    <label for="modal_password">Role</label>
                                                    <div class="input-group-addon" style="width: 2.6rem"><i class="fa fa-key"></i></div>

                                                    <select class="form-control" th:name="role" id="uRole">
                                                        <option value="user">user</option>
                                                        <option value="admin">admin</option>
                                                        <option value="admin, user">admin, user</option>
                                                    </select>

                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <button type="submit" class="btn btn-success btn-lg float-right">Edit</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <!-- /form card register -->

                            </div>

                        </div>

                    </div>
                </div>
            </div>

            <!--/dialog window-->
        </div>

    </div>
</div>


</body>
</html>